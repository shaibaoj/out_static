$(function(){0<$("#kw").length&&($(document).on("click","#js-eb-search-btn",function(){return""!=$.trim($("#kw").val())&&$("form",$("#J_searchbox"))[0].submit(),!1}),$(document).on("keydown","#kw",function(t){13==t.code&&""!=$.trim($("#kw").val())&&$("#js-eb-search-btn")[0].click()}),$(document).on("click",".search-tabs li",function(){var t=$(this).attr("data-s"),e=$(this).clone();1==t?$(this).parent().parent().find("#mod").val("index"):2==t?$(this).parent().parent().find("#mod").val("queqiao"):3==t&&$(this).parent().parent().find("#mod").val("promo"),$("#kw").attr("placeholder",$(this).attr("data-p")),$(e).addClass("current"),$(".search-tabs li").removeClass("current"),$(this).remove(),$(".search-tabs").prepend(e)}),$("#del").on("click",function(){$("#kw").val("")[0].focus(),$("#filterForm")[0].submit()})),$(".copytext-btn",$(".goods-views")).on("click",function(t){let e=$(this);var i=new ClipboardJS(".copytext-btn",{target:function(t){return e.closest(".goods").find(".media-text-area")[0]}});i.on("success",function(t){t.clearSelection(),i.destroy(),layer.msg("复制成功",{time:2e3})}),i.on("error",function(t){console.log(t)})}),$("img.lazy",$(".goods-views")).lazyload({effect:"fadeIn"}),$(".go-url").on("click",function(t){let e=$(this);e.attr("target")&&t.preventDefault(),window.open(e.attr("data-url"))})});var vmUserMenu={data:{queryInit:!1,user:{user_name:""}},mounted:function(){this.init()},methods:{init:function(){this.query()},query:function(){var e=this;ajaxPost("/api/user/home/user",{},function(t){t.data&&t.data.user&&t.data.user.user_id&&(e.user=t.data.user),e.queryInit=!0})},logout:function(){this.$storage.removeStorageSync("member_token"),window.location.href="/"}}},vmminxShopData={data:{oPublic:{reportImg:"",loadingImg:web_config.static_url+"/static/platform/images/web/common/loading.png",loadingShow:!1,wholeShow:!1,setTimeoutClear:"",setTime:300,isDatanull:!1,offsetTop:""},publicList:{productList:"",pageNumber:1,pageInput:1,count:""},oHidePopup:{hideOnLineLin:!1,hideEchartCheck:!1},oToken:{token:"",tokenTime:"",tokenBoolean:!1}},filters:{numText:function(t){return t<1e4?t:1e4<=t?Math.round(t/1e4*100)/100+"万":void 0},conversion:function(t){if(t)return t.length<=4?t:5<=t.length?Math.round(t/1e4*100)/100+"万":void 0}},watch:{"publicList.pageInput":function(t){var e=this;t>e.publicList.count&&(e.publicList.pageInput=e.publicList.count),t<1&&""!=t&&(e.publicList.pageInput=1)}},methods:{producLink:function(t){pageAll(t)},ajaxGetToken:function(){var e=this;e.oToken.tokenBoolean||ajaxPost("/indexapi/get_qiniu_token",{},function(t){"200"==t.status?(e.oToken.token=t.qiniu_token,e.oToken.tokenBoolean=!0,clearTimeout(e.oToken.tokenTime),e.setIntervalFun()):(clearTimeout(e.oToken.tokenTime),e.oToken.tokenBoolean=!1,e.oToken.token="")},function(){clearTimeout(e.oToken.tokenTime),e.oToken.tokenBoolean=!1})},setIntervalFun:function(){var t=this;this.oToken.tokenTime=setInterval(function(){t.oToken.tokenBoolean=!1},3e5)},widthFun:function(t){return 0!=t.down_type?"width:0%":"width:"+Math.round(t.couponreceive/t.couponnum*100)+"%"},pageSkipp:function(t){pageAll("/quan/"+t)},moveinIcon:function(t,e){layer.tips(t,$(e.target),{time:0,tips:[2,"#4d77ff"]})},ComremoveLayerTips:function(){var t=layer.tips();layer.close(t)},inCopywriting:function(t){var e=$(t.target).attr("datatips");layer.tips(e,$(t.target),{time:0,tips:[2,"#5cadff"],area:"440px"})},copywritingBtn:function(){var e=new ClipboardJS(".public-copy",{target:function(){return document.querySelector(".layui-layer-content")}});e.on("success",function(t){layer.msg("已复制",{time:1500}),t.clearSelection(),e.destroy()}),e.on("error",function(t){layer.msg("由于您的浏览器不兼容或当前网速较慢，复制失败，请手动复制或更换主流浏览器！",{icon:2})})},arrowTopFun:function(){$("body,html").stop(!0,!0).animate({scrollTop:0})},echartCheckFunBtn:function(t){this.oHidePopup.hideEchartCheck=!0,this.publicPopup(".js-popupEcharts"),echartCheckFun(t)},echartCheckShut:function(){this.oHidePopup.hideEchartCheck=!1,this.publicClose()},onLineLinBtn:function(t){this.oHidePopup.hideOnLineLin=!0,this.publicPopup(".js-popupOnLineLin"),onLineLinFun(t)},onLineLinShut:function(){this.oHidePopup.hideOnLineLin=!1,this.publicClose()},echoImg:function(){Echo.init({offset:0,throttle:0})},publicPopup:function(t){layer.open({type:1,shift:0,title:!1,closeBtn:1,shade:.4,content:$(t)})},publicClose:function(){layer.closeAll()},publicPopupCustom:function(t,e,i){layer.open({type:2,area:[e+"px",i+"px"],shift:0,title:!1,closeBtn:1,shade:.4,content:$(t)})}}},componentVideo={data:function(){return{oHidePopup:{hideVideo:!1},oVideo:{mp4link:"",swfLlink:"",videoTab:0}}},methods:{playVideoBtn:function(t){this.oVideo.mp4link="http://cloud.video.taobao.com/play/u/1/p/1/e/6/t/1/"+t+".mp4",this.oVideo.swfLlink="//cloud.video.taobao.com/play/u/2599950707/p/1/e/1/t/1/"+t+".swf",this.oHidePopup.hideVideo=!0,layer.open({type:1,shift:0,title:!1,closeBtn:0,shade:.4,content:$(".js-popupVideo")})},videoTabBtn:function(t){this.oVideo.videoTab=t},playVideoShut:function(){this.oVideo.videoTab=0,this.oVideo.mp4link="",this.oVideo.swfLlink="",this.oHidePopup.hideVideo=!1,layer.closeAll()}},template:'<div class="video-modal-dialog comPopupHide js-popupVideo"><div v-if="oHidePopup.hideVideo"><div class="video-modal-hd"><span>查看视频</span><i class="iconfont icon-close" @click="playVideoShut()"></i></div><div class="video-modal-bd"><div class="video-show"><video class="video-box" autoplay="autoplay" :src="oVideo.mp4link" controls="controls" v-if="oVideo.videoTab == 0"></video><object class="video-box" type="application/x-shockwave-flash" :data="oVideo.swfLlink"  v-if="oVideo.videoTab == 1"></object></div></div><div class="video-modal-footer"><span>下载视频请右键点击“视频另存为(V)...”</span><div class="video-btns"><span class="video_source" :class="[oVideo.videoTab == 0?\'video-active\':\'\']" @click="videoTabBtn(0)">视频源1</span><span class="video_source" :class="[oVideo.videoTab == 1?\'video-active\':\'\']" @click="videoTabBtn(1)">视频源2</span></div></div></div></div> '},componentLoading={props:["vmpublicc"],data:function(){return{}},methods:{},template:'<div class="loadingBox" v-if="vmpublicc"><div class="loading overall-loading"><div class="outer"></div><div class="inner"></div><div class="loading-text">数据加载中，请稍后...</div></div></div>'},componentDatanull={props:["vmdatanull","vmmsg","vmrescreen","vmnullimg"],data:function(){return{nullImg0:"//static.cdn.youdanhui.net/tatic/platform/images/web/detail/Index-null.png"}},methods:{resBtn:function(){this.$emit("vmresbtn")}},template:'<div class="inNull animatedFade animatedNaneBottom" v-if="vmdatanull"><img :src="nullImg0" class=" comUser-select" v-if="vmnullimg ==undefined"><p>{{vmmsg ==undefined?"抱歉，暂时没有筛选到合适商品":vmmsg}}</p><span v-if="vmmsg ==undefined">我们会努力寻找更多的商品哦~</span><em @click="resBtn" v-if="vmrescreen">重新筛选</em></div>'},vmPic={props:["item_id","platform_type"],data:function(){return{loadmsg:!0,cacheId:"",realPicoPage:{pageNumber:1,pageImgAll:[]}}},mounted:function(){var t,e,i=this,o=$(".realpic-box").height();$(".realpic-box").scroll(function(){t=$(this)[0].scrollHeight,e=$(this)[0].scrollTop,t<=e+o&&i.loadmsg&&i.ajaxIrealpic()})},methods:{ajaxIrealpic:function(e){var i=this;if(e){if(i.cacheId==i.item_id&&""!=i.realPicoPage.pageImgAll)return void i.CallbackRealpic();i.realPicoPage={pageNumber:1,pageImgAll:[]},i.loadmsg=!0,layer.load(2,{shade:.1}),i.cacheId=i.item_id}else i.realPicoPage.pageNumber+=1;ajaxPost("/api/common/goods/get_evaluate_imageurl",{item_id:i.item_id,platform_type:i.platform_type,page:i.realPicoPage.pageNumber},function(t){if(layer.closeAll("loading"),"200"==t.code){if(0==t.evaluate_imageurl)return i.loadmsg=!1,void(e&&layer.msg("没有实拍图哦",{time:1500,shade:.1,shadeClose:!0}));i.realPicoPage.pageImgAll=i.realPicoPage.pageImgAll.concat(t.evaluate_imageurl),i.realPicoPage.pageImgAll.length<6&&i.ajaxIrealpic(),i.$nextTick(function(){e&&i.CallbackRealpic()})}else"-1"==t.code?layer.msg("请先登录",{time:1500,shade:.1,shadeClose:!0}):layer.msg(t.msg,{icon:2,shade:.1,shadeClose:!0})})},CallbackRealpic:function(){layer.open({type:1,shift:0,title:"获取实拍图",closeBtn:2,shade:.4,area:["850px","720px"],content:$(".js-realPic")})}},template:'<div class="realPic js-realPic"><div class="realpic-box"><ul class="realPic-list clearfix"><li v-for="(item,index) in realPicoPage.pageImgAll"><img :src="item"></li></ul><p class="realpic-loading" v-if="loadmsg"> <i class="iconfont hdk-jiazai vmIconLoad"></i><em>数据加载中...</em></p><p class="realpic-loading" v-else>数据已经加载完了</p></div></div>'},oItemId="",oPlatformType=0;function echarts_show_itemid(t,e){echarts.init(document.getElementById("echarts-mail")).setOption({tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:[{name:"成交销量",textStyle:{fontSize:15,color:"#000",fontWeight:"bolder"}}]},xAxis:{gridIndex:0,type:"category",boundaryGap:!1,data:e},yAxis:{type:"value",name:"商品日销量轨迹",nameTextStyle:{color:"white",backgroundColor:"rgba(92, 173, 255, 0.8)",padding:[4,6]},nameGap:8,axisLabel:{formatter:"{value}"}},grid:{gridIndex:0,top:"8%",left:"8%",width:"880px",height:"280px"},series:[{name:"成交销量",type:"line",smooth:!0,label:{normal:{show:!0}},data:t}]})}function get_show_time(t){for(var e=6;1<=e;e--)t<e?$(".hour"+e).removeClass("echarts-clickable"):$(".hour"+e).addClass("echarts-clickable")}function onLineLinFun(t,e){autoHeight(),$.ajax({url:"/api/common/goods/api_check_material",data:Object.assign({item_id:t,platform_type:e},{hpt_times:web_config.hpt_times,hpt_sign:web_config.hpt_sign,member_token:web_config.token}),type:"post",dataType:"json",success:function(t){t=t.data.content;if(1==t.status){var e=$("#material_box").html(),i=t.item_info.shop_score;e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\{\{itemshorttitle\}\}/g,t.item_info.itemshorttitle)).replace(/\{\{itemendprice\}\}/g,parseFloat(t.item_info.itemendprice))).replace(/\{\{tkrates\}\}/g,parseFloat(t.item_info.tkrates))).replace(/\{\{tkmoney\}\}/g,parseFloat(t.item_info.tkmoney))).replace(/\{\{general_index\}\}/g,t.item_info.general_index)).replace(/\{\{itempic\}\}/g,t.item_info.itempic)).replace(/\{\{itemsale2\}\}/g,t.item_info.itemsale2)).replace(/\{\{todaysale\}\}/g,t.item_info.todaysale)).replace(/\{\{itemprice\}\}/g,parseFloat(t.item_info.itemprice))).replace(/\{\{discount\}\}/g,parseFloat(t.item_info.discount))).replace(/\{\{couponmoney\}\}/g,t.item_info.couponmoney)).replace(/\{\{couponreceive\}\}/g,t.item_info.couponreceive)).replace(/\{\{couponsurplus\}\}/g,t.item_info.couponsurplus)).replace(/\{\{itemid\}\}/g,t.item_info.itemid)).replace(/\{\{itemsale\}\}/g,t.item_info.itemsale)).replace(/\{\{grade_avg\}\}/g,t.item_info.grade_avg)).replace(/\{\{sellernick\}\}/g,t.item_info.sellernick);try{var o=JSON.parse(i);e=(e=(e=e.replace(/\{\{desc_score\}\}/g,o.desc_score)).replace(/\{\{serv_score\}\}/g,o.serv_score)).replace(/\{\{post_score\}\}/g,o.post_score)}catch(t){e=(e=(e=e.replace(/\{\{desc_score\}\}/g,"")).replace(/\{\{serv_score\}\}/g,"")).replace(/\{\{post_score\}\}/g,"")}t.main_video||void 0===t.main_video||0==t.main_video?e=e.replace(/\{\{main_video\}\}/g,"http://video.haodanku.com/"+t.main_video+"?attname="+t.material_info.main_video_url+".mp4"):$("#more_material_video").css("display","none"),""!=t.detail_video&&(e=e.replace(/\{\{detail_video\}\}/g,"http://video.haodanku.com/"+t.detail_video+"?attname="+t.material_info.detail_video_url+".mp4")),i="C"==t.item_info.shoptype?'<img src="https://img.youdanhui.cn/cms_img/2019-10-24/5db167ada0c13.png" alt="淘宝"/>':'<img src="https://img.youdanhui.cn/cms_img/2019-10-24/5db16788be2fa.png" alt="天猫"/>';try{var a=level_result(o.desc_level),n=level_result(o.serv_level),s=level_result(o.post_level);e=(e=(e=e.replace(/\{\{desc_level\}\}/g,a)).replace(/\{\{serv_level\}\}/g,n)).replace(/\{\{post_level\}\}/g,s)}catch(t){e=(e=(e=e.replace(/\{\{desc_level\}\}/g,"")).replace(/\{\{serv_level\}\}/g,"")).replace(/\{\{post_level\}\}/g,"")}e=e.replace(/\{\{shop_img\}\}/g,i);var c,r=t.material_info.seckill_content,o="",l="";for(c in r)l+='<div class="fq-copywriting"><img class="fq-copywriting_image" src="${seckill_array[seckill_i].img}" alt=""><div class="copywriting-text">${seckill_array[seckill_i].show_text}</div><span class="copy-text" style="bottom: 8px;" data-tips="<img src='+r[c].img+' alt="" style="width: 50px;">${seckill_array[seckill_i].copy_text}">复制文案</span></div>';""!=t.item_info.couponurl&&null!=t.item_info.couponurl&&(o="领券："+t.item_info.couponurl+"<br>");var d,a="<img class='fq-copywriting_image' src='"+t.item_info.itempic_copy+"' alt=''><br/>"+t.item_info.itemshorttitle+"<br/>原价"+t.item_info.itemprice+"元，券后价【"+t.item_info.itemendprice+"元】<br/>"+o+"下单:"+t.item_info.item_url+"<br/>"+t.item_info.itemdesc,n=(l+='<div class="fq-copywriting" style="background: #dedede;"><img class="fq-copywriting_image" src="'+t.item_info.itempic+'_310x310.jpg" alt=""><div class="copywriting-text">'+t.item_info.itemshorttitle+"<br>原价"+t.item_info.itemprice+"元，券后价【"+t.item_info.itemendprice+"元】<br>"+o+"下单："+t.item_info.item_url+"<br>"+t.item_info.itemdesc+'</div><span class="copy-text" data-tips="'+a+'" style="bottom: 8px; background: #4dca51;">复制文案（含链接）</span></div>',$("#js_material_box").html(e),$(".js_copywriting_box").append(l),t.material_info.image),s=0;if(1<(s=""==n&&"NULL"==n?s:(d=n.split(",")).length)){var m,p="";for(m in d)p+='<div class="material-img"><div><img src="'+d[m]+'" data-src="'+d[m]+'" alt=""><label class="img-label"><input type="radio" class="img-radio" value="'+m+'"><span class="img-radioInput"></span>实拍'+(parseInt(m)+1)+"</label></div></div>";$(".js_material_img_box").html(p),$("#more_material_img").css("display","block")}else $("#more_material_img").css("display","none");i=t.material_info.friends_circle_text,o=t.material_info.show_friends_circle_text,a=t.material_info.copy_friends_circle_text,e=(""!=i&&null!=i?($(".js_friendsCircle").append('<div class="fq-friendsCircle"><div class="friendsCircle-img"><img src="https://img.youdanhui.cn/cms_img/2019-10-24/5db157e0381d3.png" alt="" style="width: 1.875rem;" /></div><div class="friendsCircle-content"><span class="friendsCircle-title">好品生活</span><div class="friendsCircle-text">'+o+'</div><span class="copy-text" data-tips="'+a+'">复制文案</span></div></div>'),$("#friends_circle_js").css("display","block")):$("#friends_circle_js").css("display","none"),t.main_video||void 0===t.main_video||0==t.main_video||$("#more_material_video").css("display","none"),""!=t.detail_video&&null!=t.main_video?($("#video_main_url").css("display","block"),$("#video_detail_url").css("display","block")):null!=t.main_video?($("#video_main_url").css("display","block"),$("#video_detail_url").attr("src","")):""!=t.detail_video?($("#video_detail_url").css("display","block"),$("#video_main_url").attr("src","")):($("#video_main_url").attr("src",""),$("#video_detail_url").attr("src","")),"<img class='fq-copywriting_image' src='"+t.item_info.itempic_copy+"' alt=''><br/>"+t.item_info.itemshorttitle+"<br/>原价"+t.item_info.itemprice+"元，券后价【"+t.item_info.itemendprice+"元】<br/>下单:"+t.item_info.item_url+"<br/>"+t.item_info.itemdesc),n='<div class="fq-copywriting" style="background: #dedede;"><img class="fq-copywriting_image" src="'+t.item_info.itempic+'_310x310.jpg" alt=""><div class="copywriting-text">'+t.item_info.itemshorttitle+"<br>原价"+t.item_info.itemprice+"元，券后价【"+t.item_info.itemendprice+'元】<br>【领券方法】：<span class="tao_sign_str">【转淘口令】</span>长按复制该信息，打开手机淘宝，即可领券下单<br>'+t.item_info.itemdesc+'</div><span class="copy-text copy-tao" data-tips="'+e+'" style="display: none; background: #4dca51;">复制淘口令文案</span><span class="tao_sign" style="display:block">转淘口令</span></div>',s='<div class="fq-copywriting" style="background: #dedede;"><img class="fq-copywriting_image" src="'+t.item_info.itempic+'_310x310.jpg" alt=""><div class="copywriting-text">'+t.item_info.itemshorttitle+"<br>原价"+t.item_info.itemprice+"元，券后价【"+t.item_info.itemendprice+'元】<br>【领券方法】：点击链接-》领券下单  <span class="shorturl_str">【转二合一链接】</span><br>'+t.item_info.itemdesc+'</div><span class="copy-text copy-shorturl" data-tips="'+e+'" style="display: none; background: #4dca51;">复制二合一文案</span><span class="shorturl" style="display:block">转二合一</span></div>';$(".transfer_content").append(n+s),t.item_info.itemshorttitle,t.item_info.activityid,t.item_info.itempic_copy,t.item_info.itemprice,t.item_info.itemendprice,t.item_info.itemdesc,$(".js_copywriting_box").css("diaplay","none"),$(".material-left .material-active").css("diaplay","none"),$("#online_transfer").addClass("material-active"),$(".transfer_content").css("diaplay","block"),getLocation();$.ajax({url:"/api/common/stat/loginfo",type:"post",xhrFields:{withCredentials:!0},data:Object.assign({},{hpt_times:web_config.hpt_times,hpt_sign:web_config.hpt_sign,member_token:web_config.token}),success:function(t){1==t.data.loginState?t.seller_id:($(".shorturl").text("转链登录"),$(".tao_sign").text("转淘口令登录"))}})}online_modal_chian()}})}function getLocation(){var t=document.domain.split(".");return 2===t.length?document.domain:(2<t.length&&t[0],t.slice(1).join("."))}function copy_fun(t){t=new ClipboardJS("."+t,{target:function(){return document.querySelector(".all-copywriting")}});t.on("success",function(t){layer.msg("复制成功",{time:1e3}),$("#all-copywriting").html(""),t.clearSelection()}),t.on("error",function(t){layer.msg("复制失败，您当前的浏览器不兼容或网速较慢，请更换主流浏览器",{time:1800,maxWidth:"100%"}),$("#all-copywriting").html("")})}function online_modal_chian(){var t=$("#echarts").attr("data-itemid"),e=$("#echarts").attr("data-platform-type"),o=getLocation();ajaxPost("/api/common/goods/get_echarts_data",{item_id:t,platform_type:e},function(t){t=t.data.content;get_show_status(t.check_hour),echarts_show_box(t.sale,t.saletime)},function(){}),$(function(){copy_fun("copy-text"),$(".copywriting-content").on("click",".copy-text",function(){var t=$(this).attr("data-tips");$(".all-copywriting").html(t)}),$(".fq-friendsCircle").on("click",".copy-text",function(){var t=$(this).attr("data-tips");$(".all-copywriting").html(t)}),$(".transfer_content").on("click",".copy-text",function(){var t=$(this).attr("data-tips");$(".all-copywriting").html(t)})}),$(function(){copy_fun("copywriting-copy"),$(".copywriting-copy").click(function(){var t,e="";$(".copywriting-content .copy-text").each(function(){t=$(this).attr("data-tips"),e+=t}),$(".all-copywriting").html(e)})}),$(function(){$(".material-image input:radio").data("checked",!0),$(".material-image input:radio").prop("checked",!0),$(".material-image .material-img").children("div").addClass("img-active"),$(".material-image input:radio").click(function(){var t=$(this);1==t.data("checked")?(t.prop("checked",!1),t.data("checked",!1),t.parents(".material-img").children("div").removeClass("img-active")):(t.prop("checked",!0),t.data("checked",!1),t.data("checked",!0),t.parents(".material-img").children("div").addClass("img-active"))})}),$(function(){copy_fun("material-copy"),$(".material-copy").click(function(){var e="";$(".img-active").each(function(){var t=$(this).children("img").attr("data-src");e=e+"<img src="+t+"><br>",$(".all-copywriting").html(e)})})}),$(".tao_sign").click(function(){var i=window.location.protocol;seller_id?$.ajax({url:"/Onlinechain/changechain",type:"post",data:{itemid:itemid,seller_id:seller_id,title:tao_sign_title,activityid:activityid},success:function(t){var e;1==t.status?($(".tao_sign_str").text(t.data),e="<img class='fq-copywriting_image' src='"+chain_itempic+"' alt=''><br/>"+tao_sign_title+"<br/>原价"+chain_itemprice+"元，券后价【"+chain_itemendprice+"元】<br/>【领券方法】:"+t.data+"长按复制该信息，打开手机淘宝，即可领券下单<br/>"+chain_itemdesc,$(".copy-tao").attr("data-tips",e),$(".tao_sign").css("display","none"),$(".copy-tao").css("display","block")):2==t.status?layer.confirm(t.info+"，是否前往设置？",{icon:3,title:""},function(t){skip(i+"//publish."+o+"/Personal/setpid.html"),layer.close(t)}):3==t.status?layer.confirm(t.info+"，是否前往设置？",{icon:3,title:""},function(t){skip(i+"//publish."+o+"/Tbauth/index.html"),layer.close(t)}):layer.msg(t.info,{time:1200})}}):(layer.closeAll(),skip(i+"//publish."+o))}),$(".shorturl").click(function(){var i=window.location.protocol;seller_id?$.ajax({url:"/Onlinechain/changechain",type:"post",data:{itemid:itemid,seller_id:seller_id,activityid:activityid},success:function(t){var e;1==t.status?($(".shorturl_str").text(t.data),e="<img class='fq-copywriting_image' src='"+chain_itempic+"' alt=''><br/>"+tao_sign_title+"<br/>原价"+chain_itemprice+"元，券后价【"+chain_itemendprice+"元】<br/>【领券方法】：点击链接-》领券下单 "+t.data+"<br/>"+chain_itemdesc,$(".copy-shorturl").attr("data-tips",e),$(".shorturl").css("display","none"),$(".copy-shorturl").css("display","block")):2==t.status?layer.confirm(t.info+"，是否前往设置？",{icon:3,title:""},function(t){skip(i+"//publish."+o+"/Personal/setpid.html"),layer.close(t)}):3==t.status?layer.confirm(t.info+"，是否前往设置？",{icon:3,title:""},function(t){skip(i+"//publish."+o+"/Tbauth/index.html"),layer.close(t)}):layer.msg(t.info,{time:1200})}}):(layer.closeAll(),skip(i+"//publish."+o))})}function autoHeight(){var o=setInterval(function(){$(".fq-copywriting_image").each(function(){var t=$(this).height(),e=$(this).siblings(".copywriting-text").innerHeight(),i=parseInt(350-t)-36-32;0<t&&(i<parseInt(e)&&($(this).siblings(".copywriting-text").css("max-height",i),$(this).siblings(".copywriting-text").addClass("textDiv")),clearInterval(o))})},50)}function echarts_show_box(t,e){echarts.init(document.getElementById("echarts")).setOption({tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:[{name:"成交销量",textStyle:{fontSize:14,color:"#000",fontWeight:"bloder"}}]},grid:{left:64,top:30,right:30,bottom:40},xAxis:{type:"category",boundaryGap:!1,data:e},yAxis:{type:"value",axisLabel:{formatter:"{value}"},splitLine:{show:!0,lineStyle:{color:"#eaeaea"}}},series:{type:"line",smooth:!0,label:{normal:{show:!0}},symbolSize:4,itemStyle:{normal:{color:"#fe6075",borderColor:"#fe6075"}},data:t}})}function get_show_status(t){for(var e=6;1<=e;e--)t<e?($(".show_hour"+e).removeClass("clickable-time"),$(".show_hour"+e).removeClass("active-time")):e==t?($(".show_hour"+e).addClass("active-time"),$(".show_hour"+e).addClass("clickable-time")):($(".show_hour"+e).addClass("clickable-time"),$(".show_hour"+e).removeClass("active-time"))}function level_result(t){t=1==t?'<i class="iconfont hdk-top icon-color-red"></i>':-1==t?'<i class="iconfont hdk-bottom icon-color-green"></i>':'<i class="iconfont hdk-line icon-color-red"></i>';return t}function skip(t){var e=document.createElement("a");document.body.appendChild(e),e.href=t,e.target="_blank",e.click(),document.body.removeChild(e)}$(document).on("click",".echarts-clickable",function(){$(this).addClass("echarts-active").siblings().removeClass("echarts-active");var t=$(this).attr("date-time");$.ajax({url:"/api/common/goods/itemid_echarts_data",type:"post",data:Object.assign({item_id:oItemId,platform_type:oPlatformType,show_time:t},{hpt_times:web_config.hpt_times,hpt_sign:web_config.hpt_sign,member_token:web_config.token}),success:function(t){t=t.data.content;echarts_show_itemid(t.sale,t.saletime)}})}),$(".fq-chain-close").on("click",function(){$("#js_material_box").empty()}),$("body").on("click",".material-span",function(){autoHeight(),$(this).addClass("material-active").siblings().removeClass("material-active"),"图文复制"==$(this).text()?($(".copywriting-content").css("display","block"),$(".video-content").css("display","none"),$(".friendsCircle-copywriting").css("display","none"),$(".material-content").css("display","none"),$(".transfer_content").css("display","none")):"视频素材"==$(this).text()?($(".video-content").css("display","block"),$(".copywriting-content").css("display","none"),$(".friendsCircle-copywriting").css("display","none"),$(".material-content").css("display","none"),$(".transfer_content").css("display","none")):"朋友圈文案"==$(this).text()?($(".friendsCircle-copywriting").css("display","block"),$(".copywriting-content").css("display","none"),$(".video-content").css("display","none"),$(".material-content").css("display","none"),$(".transfer_content").css("display","none")):"在线转链"==$(this).text()?($(".transfer_content").css("display","block"),$(".copywriting-content").css("display","none"),$(".video-content").css("display","none"),$(".material-content").css("display","none"),$(".friendsCircle-copywriting").css("display","none"),getLocation(),$.ajax({url:"/api/common/stat/loginfo",type:"post",xhrFields:{withCredentials:!0},data:Object.assign({},{hpt_times:web_config.hpt_times,hpt_sign:web_config.hpt_sign,member_token:web_config.token}),success:function(t){1==t.data.loginState?t.seller_id:($(".tao_sign").text("转淘口令登录"),$(".shorturl").text("转链登录"))}})):($(".material-content").css("display","block"),$(".copywriting-content").css("display","none"),$(".video-content").css("display","none"),$(".friendsCircle-copywriting").css("display","none"),$(".transfer_content").css("display","none"))}),$(document).on("click",".clickable-time",function(){$(this).addClass("active-time").siblings().removeClass("active-time");var t=$("#echarts").attr("data-itemid"),e=$(this).attr("date-time");$.ajax({url:"/Index/get_echarts_data",type:"post",data:{itemid:t,show_time:e},success:function(t){echarts_show_box(t.sale,t.saletime)}})}),$(function(){var t=$(".coupon-btn");mobileUtil.isMobile,t.attr("href",t.data("url"))});var vmdetails={mixins:[vmminxShopData],data:{oCommon:{item_id:web_config.item_id,goods_sign:web_config.goods_sign,platform_type:web_config.platform_type,tianmao:"https://detail.tmall.com/item.htm",adminPidlink:"/user/info/pid",adminLoginlink:"/public/login",comloginState:!1},oItemData:{itemInfo:{},picIndex:1,sellerId:"",item_id:"",goods_sign:"",platform_type:0,taobaoImage:[],strWeixinArr:[],strFriendsArr:[],strPosterArr:[],videoImg:"",videoLink:"",imgArr:[],videoHide:!0,strShorttitle:"",strDesc:"",swiperIndex:0,friendsIndex:0,wholeShow:!1,material_id:0,material_info:[]},taobaoComment:{taobaoDataArr:[],taobaoPage:1,taobaoCount:"",taobaoCountSign:0,loadmsg:!0,taobaoLabel:[]},oHistory:{salesRecord:""},oSetting:{pidArr:[],allPidNull:!1,navId:1,templateType:1,qq:{default:"",brand:"",custom:"",token:"{口令}",link:"{短链接}",url:"{长链接}",status:0,id:0,pid:"",pidName:"",relation_id:null,show:!1},weixin:{default:"",brand:"",custom:"",token:"{口令}",link:"{短链接}",url:"{长链接}",status:0,qrcode:"",id:0,pid:"",pidName:"",relation_id:null,show:!1,linkChecked:!1,qrcodeChecked:!1},other:{id:0,pid:"",pidName:"",relation_id:null},friend:{qrcodeView:!0},poster:{picUrl1:"",picUrl2:""},comwxqqnav:[{number:0,name:"修改微信文案",bool:!0},{number:1,name:"修改QQ文案",bool:!0}],wxqqIndex:0,listArrWx:[{name:"短标题"},{name:"介绍"},{name:"店铺类型"},{name:"原价"},{name:"券后价"},{name:"销量"},{name:"佣金比例"},{name:"领券链接"},{name:"券满"},{name:"券额"},{name:"优惠券剩余数量"},{name:"优惠券有效限期"},{name:"二合一长链接"},{name:"二合一短链接"},{name:"淘口令"}],listArrQq:[{name:"短标题"},{name:"介绍"},{name:"店铺类型"},{name:"原价"},{name:"券后价"},{name:"销量"},{name:"佣金比例"},{name:"领券链接"},{name:"券满"},{name:"券额"},{name:"优惠券剩余数量"},{name:"优惠券有效限期"},{name:"二合一长链接"},{name:"二合一短链接"},{name:"淘口令"}]},oVideo:{playBool:!1,videooIndex:-1,pLink:" 0",oVoice:!0,videoData:[],oTime:0,videoitemId:"",IndexSave:"",loadIcon:!1,videosetClear:"",videooneIcon:!1},dataTime:{itemType:0,endtime:"",hours:"00",Minutes:"00",Seconds:"00",oClearInterval:"",countBoll:!0},oEchartToday:{check_hour:"",sale:[],saletime:[],tabShow:0,historyprice:[],historyMinprice:"",historytime:[]}},created:function(){""!=web_config.token&&(this.oCommon.comloginState=!0),this.ajaxInfo()},mounted:function(){},filters:{scoreFun:function(t){switch(t){case-1:return"hdk-top top-right-down";case 0:return"hdk-line";case 1:return"hdk-top"}},approveFun:function(t){switch(t){case"1":return"待认证";case"2":return"已认证";case"3":return"未验证"}},moneyConversion:function(t){if(t)return t.length<=4?t:5<=t.length?Math.round(t/1e4*100)/100:void 0},pidFilter:function(t){var e;if(t)if(2===t.length)e=t.substr(0,1)+"*";else if(2<t.length){for(var i="",o=0,a=t.length-2;o<a;o++)i+="*";e=i.substr(0,4)+t.substr(-8,4)}else e=t;return e},pidData:function(t){return t.type,t.pid+"（"+t.pid_name+"）"},copyImg:function(t){return"https://img.marsnews.work/imgcdn/"+$.md5(t)+".jpg?src="+encodeURIComponent(t)}},methods:{copyImg:function(t){return"https://img.marsnews.work/imgcdn/"+$.md5(t)+".jpg?src="+encodeURIComponent(t)},ajaxInfo:function(){var o=this;ajaxPost("/api/common/goods/view",{item_id:o.oCommon.goods_sign,goods_sign:o.oCommon.goods_sign,platform_type:o.oCommon.platform_type},function(t){if(0==t.code){o.oItemData.itemInfo=t.data.item,o.oItemData.sellerId=o.oItemData.itemInfo.goods.seller_id,o.oItemData.item_id=o.oItemData.itemInfo.goods.item_id,o.oItemData.goods_sign=o.oItemData.itemInfo.goods.goods_sign,o.oItemData.platform_type=o.oItemData.itemInfo.goods.platform_type;var e=o.oItemData.itemInfo.goods.p_list;if(e)for(var i=0;i<e.length;i++)o.oItemData.taobaoImage.push(e[i]);if(e&&o.oItemData.strWeixinArr.push(o.oItemData.taobaoImage[o.oItemData.taobaoImage.length-1]),e)for(i=0;i<e.length;i++)o.oItemData.strFriendsArr.push(e[i]);e&&o.oItemData.strPosterArr.push(o.oItemData.taobaoImage[0]),o.oItemData.itemInfo.videos&&(o.oItemData.videoImg=o.oItemData.itemInfo.videos.pic_url,o.oItemData.videoLink=o.oItemData.itemInfo.videos.url),o.oItemData.strShorttitle=o.oItemData.itemInfo.goods.d_title,o.oItemData.strShorttitle||(o.oItemData.strShorttitle=o.oItemData.itemInfo.goods.title),o.oItemData.strDesc=o.oItemData.itemInfo.goods.description,null==o.oItemData.strDesc&&(o.oItemData.strDesc=""),o.dataTime.endtime=o.oItemData.itemInfo.start_time,o.dataTime.itemType=o.oItemData.itemInfo.item_type,0<o.dataTime.itemType&&o.FunCountDown(),o.$nextTick(function(){o.oItemData.wholeShow=!0,o.ajaxComment(!0),o.ajaxhistory(),o.ajaxTodaySales()})}else layer.msg(t.message,{shade:.4,shadeClose:!0})},function(){})},ajaxhistory:function(){var i=this;ajaxPost("/api/common/goods/history",{item_id:i.oItemData.item_id,goods_sign:i.oItemData.goods_sign,platform_type:i.oItemData.platform_type},function(t){t.data.content&&"1"==t.data.content.status&&(i.oHistory.salesRecord=t.data.content.sales_record,i.oItemData.taobaoImage=i.oItemData.taobaoImage.concat(t.data.content.more_copyimage),i.oHistory.shorttitleRecommend=t.data.content.itemshorttitle_recommend,i.oHistory.descRecommend=t.data.content.itemdesc_recommend,i.$nextTick(function(){i.oHistory.salesRecord.forEach(function(t,e){i.oEchartToday.historyprice.push(parseFloat(t.itemendprice)),i.oEchartToday.historytime.push(t.time.substring(5,t.time.length))}),i.oEchartToday.historyMinprice=Math.min.apply(Math,i.oEchartToday.historyprice)}))})},ajaxTodaySales:function(){var e=this;ajaxPost("/api/common/goods/get_today_sales",{item_id:e.oItemData.item_id,goods_sign:e.oItemData.goods_sign,platform_type:e.oItemData.platform_type},function(t){t.data.content&&"1"==t.data.content.status&&(t=t.data.content.data,e.oEchartToday.check_hour=t.check_hour,e.oEchartToday.saletime=t.saletime,e.oEchartToday.sale=t.sale)},function(){})},countDown:function(t){function e(t){return(t=t.toString())[1]?t:"0"+t}var i=this,o={},t=1e3*Number(t)-Number((new Date).getTime());0<=t?(o.d=Number(Math.floor(t/864e5)),i.dataTime.hours=Number(e(parseInt(t/1e3/3600%24)))+24*o.d,i.dataTime.Minutes=e(parseInt(t/1e3/60%60)),i.dataTime.Seconds=e(parseInt(t/1e3%60))):(i.dataTime.countBoll=!1,i.dataTime.hours="00",i.dataTime.Minutes="00",i.dataTime.Seconds="00",clearInterval(i.dataTime.oClearInterval))},FunCountDown:function(){var t=this;t.dataTime.oClearInterval=setInterval(function(){t.countDown(t.dataTime.endtime)},1e3)},ajaxVideo:function(){var e=this;ajaxPost("/api/common/goods/trill_video_list",{item_id:e.oItemData.item_id,goods_sign:e.oItemData.goods_sign,platform_type:e.oItemData.platform_type,p:e.publicList.pageNumber},function(t){"1"==t.data.content.status&&(e.publicList.productList=t.data.content.data,e.publicList.count=t.data.content.count)})},adderImg:function(t){var e=$(t.target).attr("datatips");layer.tips(e,$(t.target),{skin:"popup-layer",time:0,tips:[2,"#ccc"]})},adderImg1:function(t){var e=$(t.target).attr("datatips");layer.tips(e,$(t.target),{skin:"popup-layer content-top-lookimg",time:0,tips:[1,"#fff"]})},copyBtn:function(t,e){var i=new ClipboardJS(t,{target:function(){return document.querySelector(e)}});i.on("success",function(t){layer.msg("复制成功！",{shade:.4,time:1500,shadeClose:!0}),t.clearSelection(),i.destroy()}),i.on("error",function(t){layer.msg("由于您的浏览器不兼容或当前网速较慢，复制失败，请手动复制或更换主流浏览器！",{icon:2})})},seeVideo:function(t){layer.open({type:1,title:"视频",shadeClose:!0,shade:.4,area:["560px",""],content:'<video class="comvideo" preload="auto" webkit-playsinline="true" playsinline="true" controls autoplay><source src='+t+' type="video/mp4"><source src='+t+' type="video/ogg"><source src='+t+' type="video/webm"></video>'})},seetcomment:function(){0<this.taobaoComment.taobaoCount?(this.ajaxRatelabel(),this.taobaoscroll()):layer.msg("没有评论哦",{shadeClose:!0,shade:.4})},ajaxComment:function(e){var i=this;ajaxPost("/api/common/goods/get_ratelist",{item_id:i.oItemData.item_id,goods_sign:i.oItemData.goods_sign,platform_type:i.oItemData.platform_type,pageno:i.taobaoComment.taobaoPage,pagesize:10},function(t){layer.closeAll("loading"),"1"==t.data.content.status&&(i.taobaoComment.taobaoDataArr=i.taobaoComment.taobaoDataArr.concat(t.data.content.data),i.taobaoComment.taobaoCountSign=t.data.content.count,i.taobaoComment.taobaoPage<=parseInt(i.taobaoComment.taobaoCountSign/10)?(i.taobaoComment.taobaoPage+=1,i.taobaoComment.loadmsg=!0):i.taobaoComment.loadmsg=!1,i.$nextTick(function(){e&&(i.taobaoComment.taobaoCount=t.data.content.count)}))})},taobaoscroll:function(){var t,e,i=this,o=$(".popup-taobao-comment").height();$(".popup-taobao-comment").scroll(function(){t=$(this)[0].scrollHeight,e=$(this)[0].scrollTop,parseInt(e+o)+10>=t&&i.taobaoComment.loadmsg&&(i.taobaoComment.loadmsg=!1,i.ajaxComment())})},ajaxRatelabel:function(){var e=this,t="https://rate.tmall.com/listTagClouds.htm?itemId="+e.oItemData.item_id+"&isAll=true&isInner=true&t=1570446988539&groupId=&_ksTS=1570446988540_680";layer.load(2,{shade:.1}),ajaxGetJsonp(t,{},function(t){layer.closeAll("loading"),t.tags.tagClouds&&(e.taobaoComment.taobaoLabel=t.tags.tagClouds),e.publicPopup(".jspopup-taobao")},function(){e.publicPopup(".jspopup-taobao"),layer.closeAll("loading")})},ajaxGetVideo:function(){var s=this,t="https://h5api.m.taobao.com/h5/mtop.taobao.detail.getdetail/6.0/?jsv=2.4.8&appKey=12574478&t=1554712612690&sign=59ff83eeadc620f65b072a198f4cf178&api=mtop.taobao.detail.getdetail&v=6.0&dataType=jsonp&ttid=2017%40taobao_h5_6.6.0&AntiCreep=true&type=jsonp&data=%7B%22itemNumId%22%3A%22"+s.oItemData.item_id+"%22%7D";layer.load(2,{shade:.1}),ajaxGetJsonp(t,{},function(e){layer.closeAll("loading");var t,i=[];if(e.data.apiStack){for(var o=e.data.apiStack,a=o.length;a--;){if(!(t=JSON.parse(o[a].value).item.videos))return layer.msg("没有商品视频哦!"),void(s.oItemData.videoHide=!1);for(var n=t.length;n--;)i.unshift(t[n])}if(i.length<=0)return layer.msg("没有商品视频哦!"),void(s.oItemData.videoHide=!1);s.$nextTick(function(){for(var t=0;t<i.length;t++)s.oItemData.videoLink=i[0].url,s.oItemData.videoImg=i[0].videoThumbnailURL})}else layer.alert("点击立即跳转到淘宝去拉动滑动条或登录才能获取到实拍视频哦",{icon:2,btn:"立即跳转"},function(t){pageAll(e.data.url),layer.close(t)})},function(){layer.closeAll("loading")})},loginFun:function(){var t=encodeURIComponent(encodeURIComponent(window.location.href)),e=this.oCommon.adminLoginlink+"?returnurl="+t;layer.alert("请先登录",{icon:2,btn:"立即登录"},function(t){window.location.href=e})},picBtn:function(){var t="/tools/spic?shopUrl=https://item.taobao.com/item.htm?id="+this.oItemData.item_id;pageAll(t)},tljBtn:function(){var t="/user/market/tlj?href=https://item.taobao.com/item.htm?id="+this.oItemData.item_id;pageAll(t)},wxBtn:function(){var t="/tools/wx?href=https://item.taobao.com/item.htm?id="+this.oItemData.item_id;pageAll(t)},shorttitleBtn:function(t){this.oItemData.strShorttitle=t,this.oHistory.shorttitleShow=!1},descRecommendBtn:function(t){this.oItemData.strDesc=t,this.oHistory.descRecommendShow=!1},choiceBtn:function(t,e,i){var o;1==t?0!=this.oItemData.strWeixinArr.length&&0<=(o=this.oItemData.strWeixinArr.indexOf(e))?this.oItemData.strWeixinArr.splice(o,1):this.oItemData.strWeixinArr.push(e):2==t?0!=this.oItemData.strFriendsArr.length&&0<=(o=this.oItemData.strFriendsArr.indexOf(e))?this.oItemData.strFriendsArr.splice(o,1):this.oItemData.strFriendsArr.push(e):3==t?(this.oItemData.strPosterArr=[],this.oItemData.strPosterArr.push(e)):0==t&&(this.oSetting.friend.qrcodeView=!this.oSetting.friend.qrcodeView)},filtersContent:function(t){var e=this,i=t.default;return 2==e.oSetting.templateType?i=t.brand:3==e.oSetting.templateType&&(i=t.custom),i=(i=(i=(i=(i=(i=(i=i.replace(/\{标题\}/g,e.oItemData.strShorttitle)).replace(/\{短标题\}/g,e.oItemData.strShorttitle)).replace(/\{在售价\}/g,parseFloat(e.oItemData.itemInfo.price.price))).replace(/\{券后价\}/g,"<span>"+parseFloat(e.oItemData.itemInfo.price.buy_price)+"</span>")).replace(/\{推荐语\}/g,e.oItemData.strDesc)).replace(/\{券额\}/g,"<span>"+parseFloat(e.oItemData.itemInfo.coupon.money)+"</span>")).replace(/\{图片\}/g,""),i=(i=(i=(i=(i=(i=(i=""!=t.token||""!=t.link?i.replace(/\{介绍\}/g,e.oItemData.strDesc):i.replace(/\{介绍\}/g,"文案")).replace(/\{淘口令\}/g,"<span>"+t.token+"</span>")).replace(/\{二合一\}/g,"<span>"+t.link+"</span>")).replace(/\{二合一长链接\}/g,"<span>"+t.url+"</span>")).replace(/\{二合一短链接\}/g,"<span>"+t.link+"</span>")).replace(/\{二合一淘点金短链接\}/g,"<span>"+t.link+"</span>")).replace(/\{二合一淘口令\}/g,"<span>"+t.token+"</span>")},reviseWxBtn:function(t){this.publicPopup(".jspopup-wxqq")},shutBtn:function(){this.publicClose(),this.wxqqnavReset()},wxqqnavReset:function(){this.oSetting.wxqqIndex=0,this.oSetting.comwxqqnav[0].bool=!0,this.oSetting.comwxqqnav[1].bool=!0},popupwxqqBtn:function(t){(0==t||1==t)&&""==web_config.token?this.loginFun():this.oSetting.wxqqIndex=t},customizedAdd:function(t,e){("wx"==e?document.getElementById("textareaWx"):document.getElementById("textareaQq")).focus(),this.insertAtCaret("{"+t.name+"}")},insertAtCaret:function(t){var e,i;if(window.getSelection){if((e=window.getSelection()).getRangeAt&&e.rangeCount){(i=e.getRangeAt(0)).deleteContents();for(var o,a,n=document.createElement("div"),s=(n.innerHTML=t,document.createDocumentFragment());o=n.firstChild;)a=s.appendChild(o);i.insertNode(s),a&&((i=i.cloneRange()).setStartAfter(a),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(t)},templateDefault:function(t){"wx"==t?document.getElementById("textareaWx").innerHTML=this.oSetting.weixin.default:document.getElementById("textareaQq").innerHTML=this.oSetting.qq.default},saveTemplateBtn:function(e,t){var i=this,o="";""==(o=("wx"==t?document.getElementById("textareaWx"):document.getElementById("textareaQq")).innerHTML)?layer.msg("模板不能为空",{shadeClose:!0,shade:.4}):(layer.load(2),ajaxPost("/api/user/info/template/updateItem",{share_set:e,set_content:o},function(t){layer.closeAll(),"1"==t.status?layer.msg(t.message,{shadeClose:!0,shade:.4},function(){i.publicClose(),i.wxqqnavReset()}):(layer.msg(t.message,{shadeClose:!0,shade:.4}),i.wxqqnavReset()),1==e?i.oSetting.weixin.custom=o:i.oSetting.qq.custom=o},function(){layer.closeAll(),layer.msg("网络错误",{shadeClose:!0,shade:.4}),i.wxqqnavReset()}))},templateCelarBtn:function(t){"wx"==t?document.getElementById("textareaWx").innerHTML="":document.getElementById("textareaQq").innerHTML=""},setPidBtn:function(t,e){"wx"==e?(this.oSetting.weixin.pid=t.pid,this.oSetting.weixin.pidName=t.pid_name,this.oSetting.weixin.relation_id=t.relation_id,this.oSetting.weixin.id=t.id,this.oSetting.weixin.show=!1):(this.oSetting.qq.pid=t.pid,this.oSetting.qq.pidName=t.pid_name,this.oSetting.qq.relation_id=t.relation_id,this.oSetting.qq.id=t.id,this.oSetting.qq.show=!1),this.publicClose(),layer.msg("设置成功！",{shadeClose:!0,shade:.4,time:2e3})},taobaoTokenBtn:function(e,i,t){var o,a,n=this;if(""==web_config.token)n.loginFun();else if(n.oSetting.allPidNull){switch(e){case 0:o=n.oSetting.weixin.relation_id,a=n.oSetting.weixin.pid,n.oSetting.weixin.status=1;break;case 1:o=n.oSetting.qq.relation_id,a=n.oSetting.qq.pid,n.oSetting.qq.status=1;break;case 2:o=n.oSetting.weixin.relation_id,a=n.oSetting.weixin.pid,n.oSetting.weixin.status=1;break;case 3:case 4:o=n.oSetting.weixin.relation_id,a=n.oSetting.weixin.pid}3!=e&&4!=e||""==n.oSetting.weixin.qrcode?ajaxPost("/api/common/goods/transform",{type:e,activity_id:n.oItemData.itemInfo.coupon.activity_id,item_id:n.oItemData.item_id,goods_sign:n.oItemData.goods_sign,platform_type:n.oItemData.platform_type,title:n.oItemData.itemInfo.goods.title,itempic:n.oItemData.itemInfo.goods.pic_url,relationid:o,pid:a},function(t){0==t.code?(1==e?(t.data.goods.click.password_token&&(n.oSetting.qq.token=t.data.goods.click.password_token),t.data.goods.click.short_url&&(n.oSetting.qq.link=t.data.goods.click.short_url),t.data.goods.click.url&&(n.oSetting.qq.url=t.data.goods.click.url)):(t.data.goods.click.password_token&&(n.oSetting.weixin.token=t.data.goods.click.password_token),t.data.goods.click.short_url&&(n.oSetting.weixin.link=t.data.goods.click.short_url),t.data.goods.click.url&&(n.oSetting.weixin.url=t.data.goods.click.url),t.data.goods.click.qrcode&&(n.oSetting.weixin.qrcode=t.data.goods.click.qrcode)),0==e?(n.oSetting.weixin.status=2,layer.msg("生成成功",{shade:.4,time:1e3},function(){document.querySelector(i).click()})):1==e?(n.oSetting.qq.status=2,layer.msg("生成成功",{shade:.4,time:1e3},function(){document.querySelector(i).click()})):2==e&&(n.oSetting.weixin.status=2),3==e?(n.oSetting.weixin.status=2,n.unitePic(".poster1",".copy_poster_hide1",function(t){n.oSetting.poster.picUrl1=t.img})):4==e&&(n.oSetting.weixin.status=2,n.unitePic(".poster2",".copy_poster_hide2",function(t){n.oSetting.poster.picUrl2=t.img}))):layer.msg(t.message,{shadeClose:!0,shade:.2})},function(){layer.msg("网络错误，请重新检查网络！",{shadeClose:!0,shade:.4})}):3==e?n.unitePic(".poster1",".copy_poster_hide1",function(t){n.oSetting.poster.picUrl1=t.img}):4==e&&n.unitePic(".poster2",".copy_poster_hide2",function(t){n.oSetting.poster.picUrl2=t.img})}else n.PidFun()},PidFun:function(){var e=this;layer.alert("未设置pid,请前往个人中心设置pid!",{icon:2,btn:"立即前往"},function(t){pageAll(e.oCommon.adminPidlink),layer.close(t)})},friendsBtn:function(t){this.oItemData.friendsIndex+=t},seeImg:function(t){layer.open({type:1,title:!1,closeBtn:0,area:"300px",shadeClose:!0,content:'<div><img class="viewPic" src="'+t+'"></div>'})},videoPlayBtn:function(t){var e=this;e.oVideo.videooIndex=t,setTimeout(function(){var t=e.$refs.myVideo[0];null!=t&&(null==t.error?(t.play(),e.$refs.myVideo[0].addEventListener("waiting",function(){e.oVideo.videooneIcon?e.oVideo.videosetClear=setTimeout(function(){e.oVideo.videooneIcon=!1,e.oVideo.loadIcon=!0},100):e.oVideo.loadIcon=!0}),e.$refs.myVideo[0].addEventListener("playing",function(){e.oVideo.loadIcon=!1})):e.oVideo.playBool=!1,t.addEventListener("play",function(){e.videoEnd(),e.oVideo.playBool=!0}))},100)},videostopBtn:function(){var t=this;this.$refs.myVideo[0].pause(),this.$refs.myVideo[0].addEventListener("pause",function(){t.oVideo.playBool=!1,t.oVideo.loadIcon=!1})},videoEnd:function(){var t=this;t.$refs.myVideo[0].addEventListener("ended",function(){t.$refs.myVideo[0].pause(),t.oVideo.playBool=!1})},videoExtendBtn:function(){this.oDyvideo.videoExtend=!1},videomoveinIcon:function(t,e){layer.tips(t,$(e.target),{time:0,tips:[1,"#553cf7"]})},setNav:function(t){this.oSetting.navId=t},setTemplateType:function(t){this.oSetting.templateType=t},unitePic:function(t,i,o){html2canvas(document.querySelector(t),{allowTaint:!1,useCORS:!0,logging:!0}).then(function(t){var t=t.toDataURL("image/png",1),e=new Image;e.src=t,document.querySelector(i).append(e),o({img:t})})},downImgMake:function(t){this.downloadIamge(t,Math.round(1e3*Math.random()))},downloadIamge:function(t,o){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var t=document.createElement("canvas"),e=(t.width=a.width,t.height=a.height,t.getContext("2d").drawImage(a,0,0,a.width,a.height),t=t.toDataURL("image/png"),document.createElement("a")),i=new MouseEvent("click");e.download=o||"图片",e.href=t,e.dispatchEvent(i)},a.src=t}}};function parseParams(t){try{var e,i=[];for(e in t){var o=encodeURIComponent(e),a=encodeURIComponent(t[e]);i.push(o+"="+a)}return i.join("&")}catch(t){return""}}function getUrlSearch(t,e){e=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=t.slice(t.indexOf("?")+1).match(e);if(null!=t)try{return decodeURIComponent(t[2])}catch(t){return null}return null}$(function(){function t(){web_config.item_token?e():ajaxPost("/api/common/goods/click",{item_id:web_config.item_id,goods_sign:web_config.goods_sign,platform_type:web_config.platform_type},function(t){console.log(t),t.data&&t.data.item&&t.data.item.click&&t.data.item.click.password_token&&(web_config.item_token_content=t.data.item.click.password_token,web_config.item_token=t.data.item.click.password_token,$("#goodsModalTokenContent").html(t.data.item.click.password_token),e())})}function e(){new bootstrap.Modal(document.getElementById("goodsTokenModal"),{keyboard:!1}).toggle(),$(".copytextBtn").on("click",function(){var t=("复制框内整段文字，打开【手-机-淘-宝】即可领券购买。"+web_config.item_token).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),e=new ClipboardJS(".copytextBtn",{container:document.getElementById("goodsTokenModal"),text(){return t}});e.on("success",t=>{console.info("Action:",t.action),console.info("Text:",t.text),console.info("Trigger:",t.trigger),t.clearSelection(),e.destroy(),console.log("成果"),setTimeout(()=>{},2e3)}),e.on("error",function(t){console.log(t)})})}$(".go-btn").on("click",function(){window.open(web_config.item_buy)}),$(".btn-goods-buy-token").on("click",function(){t()}),$(".btn-goods-buy-url").on("click",function(){mobileUtil.isWeixin?t():window.open(web_config.item_buy)})});var vmTestInput={isPhoneNo:function(t){return"/^1[3456789]d{9}$/".test(t)},isNumber:function(t){return"/^[0-9]*$/".test(t)},isQQ:function(t){return"/^[1-9][0-9]{4,14}/".test(t)}},page=function(t,e){e=e||"",setTimeout(function(){window.location.href=t+".html"+e},50)},pageAll=function(t){setTimeout(function(){window.open(t)},50)};function Request(t){var e,i=location.href;if(-1!=i.indexOf(t))return e=i.indexOf(t),i.substring(e+t.length+1)}function obj2String(t,e=[],i=0){for(var o in t)e[i++]=[o,t[o]];return new URLSearchParams(e).toString()}var config={_url:"",urls:"/",isHTTP:function(){var t=window.location.protocol;return t.substring(0,t.length-1)},getUrl:function(t){var e=new RegExp("(https?|ftp|file|http)://[-A-Za-z0-9+&@@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@@#/%=~_|]","ig"),t=t.match(e);return null!=t?t:null},getVideoUrl:function(t){var e=new RegExp("(https?|ftp|file|http)://[-A-Za-z0-9+&@@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@@#/%=~_|]+.mp4","ig"),t=t.match(e);return null!=t?t:null},ImgSizeFun:function(t,e){for(var i=0;i<e.length;i++)t[i]=e[i]+config.ImgSize;return t}},ajaxGet=function(t,e,i,o){var a=function(t,e){},o=(o&&(a=o),obj2String(Object.assign(e,{hpt_times:web_config.hpt_times,hpt_sign:web_config.hpt_sign,member_token:web_config.token})));fetch(0===t.indexOf("http")?t:web_config.api_url+t+"?"+o,{method:"GET"}).then(t=>t.json()).then(i).catch((t,e)=>{a(t,e)})},ajaxPost=function(t,e,i,o){var a=o?o:function(t,e){};fetch(0===t.indexOf("http")?t:web_config.api_url+t,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(Object.assign(e,{hpt_times:web_config.hpt_times,hpt_sign:web_config.hpt_sign,member_token:web_config.token}))}).then(t=>t.json()).then(i).catch((t,e)=>{a(t,e)})},ajaxGetJsonp=function(t,e,i,o){o=o||function(t,e){};$.ajax({type:"GET",url:t,data:e,dataType:"jsonp",timeout:3e4,success:i,error:o,xhrFields:{withCredentials:!0}})};window.mobileUtil=function(){var t=navigator.userAgent,e=/android|adr|linux/gi.test(t),i=/iphone|ipod|ipad/gi.test(t)&&!e,o=/BlackBerry/i.test(t),a=/IEMobile/i.test(t),n=/WeiBo/gi.test(t),o=e||i||o||a,a=/Alipay/gi.test(t);return{isAndroid:e,isIOS:i,isMobile:o,isWeixin:/MicroMessenger/gi.test(t),isQQ:/ QQ/gi.test(t),isPC:!o,isWeiBo:n,isAlipay:a}}((window,document));